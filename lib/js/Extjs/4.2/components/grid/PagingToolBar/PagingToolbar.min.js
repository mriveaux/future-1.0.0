
Ext.ns("Ext.Feet");Ext.define("Ext.Feet.PagingToolbar",{extend:"Ext.toolbar.Toolbar",alias:"widget.feetpagingtoolbar",alternateClassName:"Ext.PagingToolbar",requires:["Ext.toolbar.TextItem","Ext.form.field.Number"],mixins:{bindable:"Ext.util.Bindable"},displayInfo:false,prependButtons:false,displayMsg:"Displaying {0} - {1} of {2}",emptyMsg:"No data to display",beforePageText:"Page",afterPageText:"of {0}",firstText:"First Page",prevText:"Previous Page",nextText:"Next Page",lastText:"Last Page",refreshText:"Refresh",inputItemWidth:30,initComponent:function(){var b=this,c=b.getPagingItems(),a=b.items||b.buttons||[];if(b.prependButtons){b.items=a.concat(c)}else{b.items=c.concat(a)}delete b.buttons;if(b.displayInfo){b.items.push("->");b.items.push({xtype:"tbtext",itemId:"displayItem"})}b.callParent(arguments);b.addEvents("change","beforechange");b.on("beforerender",b.onLoad,b,{single:true});b.bindStore(b.store||"ext-empty-store",true)},getPagingItems:function(){var c=this;c.stPagingBottomBar=Ext.create("Ext.data.Store",{storeId:"stPagingBottomBar",fields:["page"],data:[{page:"5"},{page:"10"},{page:"15"},{page:"20"},{page:"30"},{page:"40"},{page:"50"},{page:"60"},{page:"70"},{page:"80"},{page:"90"},{page:"100"},{page:"250"},{page:"500"},{page:"1000"}]});var b=Ext.data.StoreManager.lookup(c.store);var a=(b==undefined)?20:b.pageSize;var d=Math.min(c.stPagingBottomBar.currentPage*a,a+1);c.cbPageSize=Ext.create("Ext.form.ComboBox",{value:d||20,store:c.stPagingBottomBar,queryMode:"local",displayField:"page",valueField:"page",triggerAction:"all",editable:false,width:55,listeners:{scope:this,select:function(e){var f=c.getPageData();f.toRecord=e.getValue();c.store.pageSize=e.getValue();c.store.currentPage=1;if(c.fireEvent("beforechange",c,1)!==false){c.store.loadPage(1,{start:0,limit:f.toRecord})}}}});return[{itemId:"first",tooltip:c.firstText,overflowText:c.firstText,iconCls:Ext.baseCSSPrefix+"tbar-page-first",disabled:true,handler:c.moveFirst,scope:c},{itemId:"prev",tooltip:c.prevText,overflowText:c.prevText,iconCls:Ext.baseCSSPrefix+"tbar-page-prev",disabled:true,handler:c.movePrevious,scope:c},"-",c.beforePageText,{xtype:"numberfield",itemId:"inputItem",name:"inputItem",cls:Ext.baseCSSPrefix+"tbar-page-number",allowDecimals:false,minValue:1,hideTrigger:true,enableKeyEvents:true,keyNavEnabled:false,selectOnFocus:true,submitValue:false,isFormField:false,width:c.inputItemWidth,margins:"-1 2 3 2",listeners:{scope:c,keydown:c.onPagingKeyDown,blur:c.onPagingBlur}},{xtype:"tbtext",itemId:"afterTextItem",text:Ext.String.format(c.afterPageText,1)},"-",{itemId:"next",tooltip:c.nextText,overflowText:c.nextText,iconCls:Ext.baseCSSPrefix+"tbar-page-next",disabled:true,handler:c.moveNext,scope:c},{itemId:"last",tooltip:c.lastText,overflowText:c.lastText,iconCls:Ext.baseCSSPrefix+"tbar-page-last",disabled:true,handler:c.moveLast,scope:c},"-",c.cbPageSize,"-",{itemId:"refresh",tooltip:c.refreshText,overflowText:c.refreshText,iconCls:Ext.baseCSSPrefix+"tbar-loading",handler:c.doRefresh,scope:c}]},updateInfo:function(){var e=this,c=e.child("#displayItem"),a=e.store,b=e.getPageData(),d,f;if(c){d=a.getCount();if(d===0){f=e.emptyMsg}else{f=Ext.String.format(e.displayMsg,b.fromRecord,b.toRecord,b.total)}c.setText(f)}},onLoad:function(){var g=this,d,b,c,a,f,h,e;f=g.store.getCount();h=f===0;if(!h){d=g.getPageData();b=d.currentPage;c=d.pageCount;a=Ext.String.format(g.afterPageText,isNaN(c)?1:c)}else{b=0;c=0;a=Ext.String.format(g.afterPageText,0)}Ext.suspendLayouts();e=g.child("#afterTextItem");if(e){e.setText(a)}e=g.getInputItem();if(e){e.setDisabled(h).setValue(b)}g.setChildDisabled("#first",b===1||h);g.setChildDisabled("#prev",b===1||h);g.setChildDisabled("#next",b===c||h);g.setChildDisabled("#last",b===c||h);g.setChildDisabled("#refresh",false);g.updateInfo();Ext.resumeLayouts(true);if(g.rendered){g.fireEvent("change",g,d)}},setChildDisabled:function(a,b){var c=this.child(a);if(c){c.setDisabled(b)}},getPageData:function(){var c=this.store,b=c.getTotalCount(),a=this.cbPageSize.getValue()||c.pageSize;return{total:b,currentPage:c.currentPage,pageCount:Math.ceil(b/a),fromRecord:((c.currentPage-1)*a)+1,toRecord:Math.min(c.currentPage*a,b)}},onLoadError:function(){if(!this.rendered){return}this.setChildDisabled("#refresh",false)},getInputItem:function(){return this.child("#inputItem")},readPageFromInput:function(b){var c=this.getInputItem(),d=false,a;if(c){a=c.getValue();d=parseInt(a,10);if(!a||isNaN(d)){c.setValue(b.currentPage);return false}}return d},onPagingFocus:function(){var a=this.getInputItem();if(a){a.select()}},onPagingBlur:function(c){var b=this.getInputItem(),a;if(b){a=this.getPageData().currentPage;b.setValue(a)}},onPagingKeyDown:function(h,g){var d=this,b=g.getKey(),c=d.getPageData(),a=g.shiftKey?10:1,f;if(b==g.RETURN){g.stopEvent();f=d.readPageFromInput(c);if(f!==false){f=Math.min(Math.max(1,f),c.pageCount);if(d.fireEvent("beforechange",d,f)!==false){d.store.loadPage(f)}}}else{if(b==g.HOME||b==g.END){g.stopEvent();f=b==g.HOME?1:c.pageCount;h.setValue(f)}else{if(b==g.UP||b==g.PAGE_UP||b==g.DOWN||b==g.PAGE_DOWN){g.stopEvent();f=d.readPageFromInput(c);if(f){if(b==g.DOWN||b==g.PAGE_DOWN){a*=-1}f+=a;if(f>=1&&f<=c.pageCount){h.setValue(f)}}}}}},beforeLoad:function(){if(this.rendered){this.setChildDisabled("#refresh",true)}},moveFirst:function(){if(this.fireEvent("beforechange",this,1)!==false){this.store.loadPage(1)}},movePrevious:function(){var b=this,a=b.store.currentPage-1;if(a>0){if(b.fireEvent("beforechange",b,a)!==false){b.store.previousPage()}}},moveNext:function(){var c=this,b=c.getPageData().pageCount,a=c.store.currentPage+1;if(a<=b){if(c.fireEvent("beforechange",c,a)!==false){c.store.nextPage()}}},moveLast:function(){var b=this,a=b.getPageData().pageCount;if(b.fireEvent("beforechange",b,a)!==false){b.store.loadPage(a)}},doRefresh:function(){var a=this,b=a.store.currentPage;if(a.fireEvent("beforechange",a,b)!==false){a.store.loadPage(b)}},getStoreListeners:function(){return{beforeload:this.beforeLoad,load:this.onLoad,exception:this.onLoadError}},unbind:function(a){this.bindStore(null)},bind:function(a){this.bindStore(a)},onDestroy:function(){this.unbind();this.callParent()}});