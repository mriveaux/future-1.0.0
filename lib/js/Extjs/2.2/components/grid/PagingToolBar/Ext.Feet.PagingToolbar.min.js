
Ext.ns("Ext.Feet");Ext.Feet.PagingToolbar=Ext.extend(Ext.Toolbar,{pageSize:20,displayMsg:"Resultados {0} - {1} de {2}",emptyMsg:"No hay resultados para mostrar",beforePageText:"P\xE1gina",afterPageText:"de {0}",firstText:"Primera p\xE1gina",prevText:"P\xE1gina anterior",nextText:"P\xE1gina siguiente",lastText:"\xDAltima p\xE1gina",refreshText:"Actualizar",prevStepText:"Anterior",nextStepText:"Siguiente",paramNames:{start:"start",limit:"limit"},btnsConfig:[],legend:[],steps:5,pageConfig:{first:true,prev:true,next:true,last:true,loading:true,field:true,prevstep:true,nextstep:true,pagepanel:true,dispalyNum:true},initStep:function(){this.steps=this.steps},getHalfStep:function(){return parseInt(this.steps/2)},initComponent:function(){this.addEvents("change","beforechange");Ext.Feet.PagingToolbar.superclass.initComponent.call(this);this.cursor=0;this.bind(this.store)},addLegendNode:function(a){var b="";accion=a[0];text=a[1];b+="<div class='animacionContenedor"+accion+" contenedorLeyenda'><div class='iconLeyenda "+accion+"Leyend'></div><div class='textLeyenda "+accion+"LeyendColor'><strong>"+text+"</strong></div>";return b},onRender:function(c,a){Ext.Feet.PagingToolbar.superclass.onRender.call(this,c,a);this.initStep();for(var b=0;b<=this.btnsConfig.length-1;b++){this.btngroup=this.addButton({text:this.btnsConfig[b].text,tooltip:this.btnsConfig[b].tooltip,iconCls:this.btnsConfig[b].iconCls,handler:this.btnsConfig[b].handler});this.addSeparator()}this.first=this.addButton({tooltip:this.firstText,iconCls:"x-tbar-page-first",disabled:true,handler:this.onClick.createDelegate(this,["first"])});this.firstbar=this.addSeparator();this.prev=this.addButton({tooltip:this.prevText,iconCls:"x-tbar-page-prev",disabled:true,handler:this.onClick.createDelegate(this,["prev"])});this.prevbar=this.addSeparator();for(var d=1;d<=this.steps;d++){this.pagePanel=this.addButton({id:this.id+"_btn"+d,tooltip:"PÃ¡gina #"+d,text:"",handler:this.onClick.createDelegate(this,["jump",d])})}this.pagepanelbar=this.addSeparator();this.beforeTextEl=this.add(this.beforePageText);this.field=Ext.get(this.addDom({tag:"input",type:"text",size:"3",value:"1",cls:"x-tbar-page-number"}).el);this.field.on("keydown",this.onPagingKeydown,this);this.field.on("focus",function(){this.dom.select()});this.afterTextEl=this.addText(String.format(this.afterPageText,1));this.field.setHeight(18);this.fieldbar=this.addSeparator();this.next=this.addButton({tooltip:this.nextText,iconCls:"x-tbar-page-next",disabled:true,handler:this.onClick.createDelegate(this,["next"])});this.nextbar=this.addSeparator();this.last=this.addButton({tooltip:this.lastText,iconCls:"x-tbar-page-last",disabled:true,handler:this.onClick.createDelegate(this,["last"])});this.nextstepbar=this.addSeparator();this.displayNum=this.addItem(new Ext.form.ComboBox({triggerAction:"all",store:new Ext.data.SimpleStore({fields:["text"],data:[["5"],["10"],["15"],["20"],["30"],["40"],["50"],["60"],["70"],["80"],["90"],["100"],["500"],["1000"]]}),displayField:"text",valueField:"text",mode:"local",readOnly:true,value:this.pageSize,width:50,cls:"tamanocombo",listeners:{select:this.onClick.createDelegate(this,["displaynum"]),scope:this}}));this.lastbar=this.addSeparator();this.loading=this.addButton({tooltip:this.refreshText,iconCls:"x-tbar-loading",handler:this.onClick.createDelegate(this,["refresh"])});if(this.legend.length>0){this.add("->");for(var b=0;b<this.legend.length;b++){this.legendLegacy=this.add({xtype:"label",html:this.addLegendNode(this.legend[b])})}}if(this.displayInfo){this.displayEl=Ext.fly(this.el.dom).createChild({cls:"x-paging-info"})}if(this.dsLoaded){this.onLoad.apply(this,this.dsLoaded)}},updateInfo:function(){if(this.displayEl){var a=this.store.getCount();var b=a==0?this.emptyMsg:String.format(this.displayMsg,this.cursor+1,this.cursor+a,this.store.getTotalCount());this.displayEl.update(b)}},onLoad:function(a,e,h){if(!this.rendered){this.dsLoaded=[a,e,h];return}this.initStep();this.cursor=a.baseParams.start?a.baseParams.start:0;var g=this.getPageData(),c=g.activePage,f=g.pages;if(f<=this.steps){for(var i=1;i<=f;i++){Ext.getCmp(this.id+"_btn"+i).setText(i);if(c==i){Ext.getCmp(this.id+"_btn"+i).el.child("button").setStyle({"font-weight":"bold"})}else{Ext.getCmp(this.id+"_btn"+i).el.child("button").setStyle({background:"","font-weight":"normal"})}Ext.getCmp(this.id+"_btn"+i).handler=this.onClick.createDelegate(this,["jump",i])}for(var i=1;i<=this.steps;i++){if(i<=f){Ext.getCmp(this.id+"_btn"+i).setDisabled(false)}else{Ext.getCmp(this.id+"_btn"+i).setText("");Ext.getCmp(this.id+"_btn"+i).setDisabled(true)}}}else{for(var i=1,b=(c-this.getHalfStep())>=1?(c-this.getHalfStep()):1;i<=this.steps;i++,b++){Ext.getCmp(this.id+"_btn"+i).setText(b);if(c==b){Ext.getCmp(this.id+"_btn"+i).el.child("button").setStyle({"font-weight":"bold"})}else{Ext.getCmp(this.id+"_btn"+i).el.child("button").setStyle({background:"","font-weight":"normal"})}Ext.getCmp(this.id+"_btn"+i).handler=this.onClick.createDelegate(this,["jump",b]);if(c+i-this.getHalfStep()-2>=f){Ext.getCmp(this.id+"_btn"+i).setDisabled(true);Ext.getCmp(this.id+"_btn"+i).setText("")}else{Ext.getCmp(this.id+"_btn"+i).setDisabled(false)}}}this.field.dom.value=c;this.first.setDisabled(c==1);this.prev.setDisabled(c==1);this.next.setDisabled(c==f);this.last.setDisabled(c==f);this.loading.enable();this.updateInfo();this.fireEvent("change",this,g);Ext.fly(this.afterTextEl.el.id).update(String.format(this.afterPageText,f));this.first.setVisible(this.pageConfig.first);this.firstbar.setVisible(this.pageConfig.first);this.prev.setVisible(this.pageConfig.prev);this.prevbar.setVisible(this.pageConfig.prev);this.next.setVisible(this.pageConfig.next);this.nextbar.setVisible(this.pageConfig.next);this.last.setVisible(this.pageConfig.last);this.lastbar.setVisible(this.pageConfig.last);this.loading.setVisible(this.pageConfig.loading);this.field.setVisible(this.pageConfig.field);this.fieldbar.setVisible(this.pageConfig.field);this.nextstepbar.setVisible(this.pageConfig.nextstep);this.displayNum.setVisible(this.pageConfig.dispalyNum);this.nextstepbar.setVisible(this.pageConfig.dispalyNum);this.pagepanelbar.setVisible(this.pageConfig.pagepanel)},getPageData:function(){var a=this.store.getTotalCount();return{total:a,activePage:Math.ceil((this.cursor+this.pageSize)/this.pageSize),pages:a<this.pageSize?1:Math.ceil(a/this.pageSize)}},onLoadError:function(){if(!this.rendered){return}this.loading.enable()},readPage:function(c){var a=this.field.dom.value,b;if(!a||isNaN(b=parseInt(a,10))){this.field.dom.value=c.activePage;return false}return b},onPagingKeydown:function(f){var b=f.getKey(),g=this.getPageData(),c;if(b==f.RETURN){f.stopEvent();if(c=this.readPage(g)){c=Math.min(Math.max(1,c),g.pages)-1;this.doLoad(c*this.pageSize)}}else{if(b==f.HOME||b==f.END){f.stopEvent();c=b==f.HOME?1:g.pages;this.field.dom.value=c}else{if(b==f.UP||b==f.PAGEUP||b==f.DOWN||b==f.PAGEDOWN){f.stopEvent();if(c=this.readPage(g)){var a=f.shiftKey?10:1;if(b==f.DOWN||b==f.PAGEDOWN){a*=-1}c+=a;if(c>=1&c<=g.pages){this.field.dom.value=c}}}}}},beforeLoad:function(){if(this.rendered&&this.loading){this.loading.disable()}if(this.store.baseParams.start==undefined){this.store.baseParams.start=0}this.store.baseParams.limit=this.pageSize},doLoad:function(a){this.store.baseParams.start=a;this.store.baseParams.limit=this.pageSize;if(this.fireEvent("beforechange",this,this.store.baseParams)!==false){this.store.load()}},displaynum:function(a){this.pageSize=parseInt(this.displayNum.getValue());this.store.baseParams.start=a;this.store.baseParams.limit=this.pageSize;this.store.load()},changePage:function(a){this.doLoad(((a-1)*this.pageSize).constrain(0,this.store.getTotalCount()))},onClick:function(f,e){var b=this.store;switch(f){case"first":this.doLoad(0);break;case"prev":this.doLoad(Math.max(0,this.cursor-this.pageSize));break;case"next":this.doLoad(this.cursor+this.pageSize);break;case"last":var d=b.getTotalCount();var a=d%this.pageSize;var c=a?(d-a):d-this.pageSize;this.doLoad(c);break;case"refresh":this.doLoad(this.cursor);break;case"jump":this.doLoad(this.pageSize*(e-1));break;case"prevstep":this.doLoad(this.cursor-this.steps*this.pageSize);break;case"nextstep":this.doLoad(this.cursor+this.steps*this.pageSize);break;case"displaynum":this.displaynum(0);break}},unbind:function(a){a=Ext.StoreMgr.lookup(a);a.un("beforeload",this.beforeLoad,this);a.un("load",this.onLoad,this);a.un("loadexception",this.onLoadError,this);this.store=undefined},bind:function(a){a=Ext.StoreMgr.lookup(a);a.on("beforeload",this.beforeLoad,this);a.on("load",this.onLoad,this);a.on("loadexception",this.onLoadError,this);this.store=a}});Ext.reg("paging",Ext.Feet.PagingToolbar);